/* empty css                       */function E(){}const He=s=>s;function Ve(s){return s()}function Re(){return Object.create(null)}function M(s){s.forEach(Ve)}function Ee(s){return typeof s=="function"}function te(s,e){return s!=s?e==e:s!==e||s&&typeof s=="object"||typeof s=="function"}let ue;function Ae(s,e){return s===e?!0:(ue||(ue=document.createElement("a")),ue.href=e,s===ue.href)}function rt(s){return Object.keys(s).length===0}function ot(s,...e){if(s==null){for(const n of e)n(void 0);return E}const t=s.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Pe(s,e,t){s.$$.on_destroy.push(ot(e,t))}function Se(s,e,t){return s.set(t),e}const Ge=typeof window<"u";let at=Ge?()=>window.performance.now():()=>Date.now(),$e=Ge?s=>requestAnimationFrame(s):E;const X=new Set;function ze(s){X.forEach(e=>{e.c(s)||(X.delete(e),e.f())}),X.size!==0&&$e(ze)}function ct(s){let e;return X.size===0&&$e(ze),{promise:new Promise(t=>{X.add(e={c:s,f:t})}),abort(){X.delete(e)}}}let we=!1;function lt(){we=!0}function ut(){we=!1}function ht(s,e,t,n){for(;s<e;){const i=s+(e-s>>1);t(i)<=n?s=i+1:e=i}return s}function dt(s){if(s.hydrate_init)return;s.hydrate_init=!0;let e=s.childNodes;if(s.nodeName==="HEAD"){const l=[];for(let a=0;a<e.length;a++){const u=e[a];u.claim_order!==void 0&&l.push(u)}e=l}const t=new Int32Array(e.length+1),n=new Int32Array(e.length);t[0]=-1;let i=0;for(let l=0;l<e.length;l++){const a=e[l].claim_order,u=(i>0&&e[t[i]].claim_order<=a?i+1:ht(1,i,f=>e[t[f]].claim_order,a))-1;n[l]=t[u]+1;const h=u+1;t[h]=l,i=Math.max(h,i)}const r=[],o=[];let c=e.length-1;for(let l=t[i]+1;l!=0;l=n[l-1]){for(r.push(e[l-1]);c>=l;c--)o.push(e[c]);c--}for(;c>=0;c--)o.push(e[c]);r.reverse(),o.sort((l,a)=>l.claim_order-a.claim_order);for(let l=0,a=0;l<o.length;l++){for(;a<r.length&&o[l].claim_order>=r[a].claim_order;)a++;const u=a<r.length?r[a]:null;s.insertBefore(o[l],u)}}function ft(s,e){s.appendChild(e)}function Je(s){if(!s)return document;const e=s.getRootNode?s.getRootNode():s.ownerDocument;return e&&e.host?e:s.ownerDocument}function pt(s){const e=S("style");return e.textContent="/* empty */",mt(Je(s),e),e.sheet}function mt(s,e){return ft(s.head||s,e),e.sheet}function _(s,e){if(we){for(dt(s),(s.actual_end_child===void 0||s.actual_end_child!==null&&s.actual_end_child.parentNode!==s)&&(s.actual_end_child=s.firstChild);s.actual_end_child!==null&&s.actual_end_child.claim_order===void 0;)s.actual_end_child=s.actual_end_child.nextSibling;e!==s.actual_end_child?(e.claim_order!==void 0||e.parentNode!==s)&&s.insertBefore(e,s.actual_end_child):s.actual_end_child=e.nextSibling}else(e.parentNode!==s||e.nextSibling!==null)&&s.appendChild(e)}function $(s,e,t){we&&!t?_(s,e):(e.parentNode!==s||e.nextSibling!=t)&&s.insertBefore(e,t||null)}function g(s){s.parentNode&&s.parentNode.removeChild(s)}function S(s){return document.createElement(s)}function H(s){return document.createTextNode(s)}function j(){return H(" ")}function K(s,e,t,n){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t,n)}function Qe(s){return function(e){return e.preventDefault(),s.call(this,e)}}function O(s,e,t){t==null?s.removeAttribute(e):s.getAttribute(e)!==t&&s.setAttribute(e,t)}function V(s){return s.dataset.svelteH}function A(s){return Array.from(s.childNodes)}function bt(s){s.claim_info===void 0&&(s.claim_info={last_index:0,total_claimed:0})}function Ye(s,e,t,n,i=!1){bt(s);const r=(()=>{for(let o=s.claim_info.last_index;o<s.length;o++){const c=s[o];if(e(c)){const l=t(c);return l===void 0?s.splice(o,1):s[o]=l,i||(s.claim_info.last_index=o),c}}for(let o=s.claim_info.last_index-1;o>=0;o--){const c=s[o];if(e(c)){const l=t(c);return l===void 0?s.splice(o,1):s[o]=l,i?l===void 0&&s.claim_info.last_index--:s.claim_info.last_index=o,c}}return n()})();return r.claim_order=s.claim_info.total_claimed,s.claim_info.total_claimed+=1,r}function gt(s,e,t,n){return Ye(s,i=>i.nodeName===e,i=>{const r=[];for(let o=0;o<i.attributes.length;o++){const c=i.attributes[o];t[c.name]||r.push(c.name)}r.forEach(o=>i.removeAttribute(o))},()=>n(e))}function C(s,e,t){return gt(s,e,t,S)}function Z(s,e){return Ye(s,t=>t.nodeType===3,t=>{const n=""+e;if(t.data.startsWith(n)){if(t.data.length!==n.length)return t.splitText(n.length)}else t.data=n},()=>H(e),!0)}function q(s){return Z(s," ")}function ke(s,e){e=""+e,s.data!==e&&(s.data=e)}function Y(s,e){s.value=e??""}function yt(s,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:n})}const me=new Map;let be=0;function wt(s){let e=5381,t=s.length;for(;t--;)e=(e<<5)-e^s.charCodeAt(t);return e>>>0}function _t(s,e){const t={stylesheet:pt(e),rules:{}};return me.set(s,t),t}function St(s,e,t,n,i,r,o,c=0){const l=16.666/n;let a=`{
`;for(let v=0;v<=1;v+=l){const y=e+(t-e)*r(v);a+=v*100+`%{${o(y,1-y)}}
`}const u=a+`100% {${o(t,1-t)}}
}`,h=`__svelte_${wt(u)}_${c}`,f=Je(s),{stylesheet:d,rules:m}=me.get(f)||_t(f,s);m[h]||(m[h]=!0,d.insertRule(`@keyframes ${h} ${u}`,d.cssRules.length));const b=s.style.animation||"";return s.style.animation=`${b?`${b}, `:""}${h} ${n}ms linear ${i}ms 1 both`,be+=1,h}function je(s,e){const t=(s.style.animation||"").split(", "),n=t.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),i=t.length-n.length;i&&(s.style.animation=n.join(", "),be-=i,be||vt())}function vt(){$e(()=>{be||(me.forEach(s=>{const{ownerNode:e}=s.stylesheet;e&&g(e)}),me.clear())})}let ie;function se(s){ie=s}function Xe(){if(!ie)throw new Error("Function called outside component initialization");return ie}function Ct(s){Xe().$$.on_mount.push(s)}function kt(s){Xe().$$.on_destroy.push(s)}function Ot(s,e){const t=s.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const Q=[],Oe=[];let ee=[];const qe=[],Tt=Promise.resolve();let Te=!1;function Et(){Te||(Te=!0,Tt.then(Ze))}function re(s){ee.push(s)}const ve=new Set;let z=0;function Ze(){if(z!==0)return;const s=ie;do{try{for(;z<Q.length;){const e=Q[z];z++,se(e),Pt(e.$$)}}catch(e){throw Q.length=0,z=0,e}for(se(null),Q.length=0,z=0;Oe.length;)Oe.pop()();for(let e=0;e<ee.length;e+=1){const t=ee[e];ve.has(t)||(ve.add(t),t())}ee.length=0}while(Q.length);for(;qe.length;)qe.pop()();Te=!1,ve.clear(),se(s)}function Pt(s){if(s.fragment!==null){s.update(),M(s.before_update);const e=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,e),s.after_update.forEach(re)}}function $t(s){const e=[],t=[];ee.forEach(n=>s.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),ee=e}let ne;function It(){return ne||(ne=Promise.resolve(),ne.then(()=>{ne=null})),ne}function Le(s,e,t){s.dispatchEvent(yt(`${e?"intro":"outro"}${t}`))}const fe=new Set;let W;function Ue(){W={r:0,c:[],p:W}}function Ne(){W.r||M(W.c),W=W.p}function N(s,e){s&&s.i&&(fe.delete(s),s.i(e))}function B(s,e,t,n){if(s&&s.o){if(fe.has(s))return;fe.add(s),W.c.push(()=>{fe.delete(s),n&&(t&&s.d(1),n())}),s.o(e)}else n&&n()}const xt={duration:0};function Rt(s,e,t){const n={direction:"in"};let i=e(s,t,n),r=!1,o,c,l=0;function a(){o&&je(s,o)}function u(){const{delay:f=0,duration:d=300,easing:m=He,tick:b=E,css:v}=i||xt;v&&(o=St(s,0,1,d,f,m,v,l++)),b(0,1);const y=at()+f,P=y+d;c&&c.abort(),r=!0,re(()=>Le(s,!0,"start")),c=ct(w=>{if(r){if(w>=P)return b(1,0),Le(s,!0,"end"),a(),r=!1;if(w>=y){const I=m((w-y)/d);b(I,1-I)}}return r})}let h=!1;return{start(){h||(h=!0,je(s),Ee(i)?(i=i(n),It().then(u)):u())},invalidate(){h=!1},end(){r&&(a(),r=!1)}}}function De(s){return s?.length!==void 0?s:Array.from(s)}function At(s,e){s.d(1),e.delete(s.key)}function jt(s,e,t,n,i,r,o,c,l,a,u,h){let f=s.length,d=r.length,m=f;const b={};for(;m--;)b[s[m].key]=m;const v=[],y=new Map,P=new Map,w=[];for(m=d;m--;){const T=h(i,r,m),p=t(T);let k=o.get(p);k?n&&w.push(()=>k.p(T,e)):(k=a(p,T),k.c()),y.set(p,v[m]=k),p in b&&P.set(p,Math.abs(m-b[p]))}const I=new Set,x=new Set;function R(T){N(T,1),T.m(c,u),o.set(T.key,T),u=T.first,d--}for(;f&&d;){const T=v[d-1],p=s[f-1],k=T.key,L=p.key;T===p?(u=T.first,f--,d--):y.has(L)?!o.has(k)||I.has(k)?R(T):x.has(L)?f--:P.get(k)>P.get(L)?(x.add(k),R(T)):(I.add(L),f--):(l(p,o),f--)}for(;f--;){const T=s[f];y.has(T.key)||l(T,o)}for(;d;)R(v[d-1]);return M(w),v}function ge(s){s&&s.c()}function ye(s,e){s&&s.l(e)}function oe(s,e,t){const{fragment:n,after_update:i}=s.$$;n&&n.m(e,t),re(()=>{const r=s.$$.on_mount.map(Ve).filter(Ee);s.$$.on_destroy?s.$$.on_destroy.push(...r):M(r),s.$$.on_mount=[]}),i.forEach(re)}function ae(s,e){const t=s.$$;t.fragment!==null&&($t(t.after_update),M(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function qt(s,e){s.$$.dirty[0]===-1&&(Q.push(s),Et(),s.$$.dirty.fill(0)),s.$$.dirty[e/31|0]|=1<<e%31}function ce(s,e,t,n,i,r,o=null,c=[-1]){const l=ie;se(s);const a=s.$$={fragment:null,ctx:[],props:r,update:E,not_equal:i,bound:Re(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Re(),dirty:c,skip_bound:!1,root:e.target||l.$$.root};o&&o(a.root);let u=!1;if(a.ctx=t?t(s,e.props||{},(h,f,...d)=>{const m=d.length?d[0]:f;return a.ctx&&i(a.ctx[h],a.ctx[h]=m)&&(!a.skip_bound&&a.bound[h]&&a.bound[h](m),u&&qt(s,h)),f}):[],a.update(),u=!0,M(a.before_update),a.fragment=n?n(a.ctx):!1,e.target){if(e.hydrate){lt();const h=A(e.target);a.fragment&&a.fragment.l(h),h.forEach(g)}else a.fragment&&a.fragment.c();e.intro&&N(s.$$.fragment),oe(s,e.target,e.anchor),ut(),Ze()}se(l)}class le{$$=void 0;$$set=void 0;$destroy(){ae(this,1),this.$destroy=E}$on(e,t){if(!Ee(t))return E;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!rt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Lt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Lt);class D extends Error{constructor(e){super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,D.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof D||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=this.response?.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":this.originalError?.cause?.message?.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const he=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Ut(s,e){const t={};if(typeof s!="string")return t;const n=Object.assign({},e||{}).decode||Nt;let i=0;for(;i<s.length;){const r=s.indexOf("=",i);if(r===-1)break;let o=s.indexOf(";",i);if(o===-1)o=s.length;else if(o<r){i=s.lastIndexOf(";",r-1)+1;continue}const c=s.slice(i,r).trim();if(t[c]===void 0){let l=s.slice(r+1,o).trim();l.charCodeAt(0)===34&&(l=l.slice(1,-1));try{t[c]=n(l)}catch{t[c]=l}}i=o+1}return t}function Fe(s,e,t){const n=Object.assign({},t||{}),i=n.encode||Dt;if(!he.test(s))throw new TypeError("argument name is invalid");const r=i(e);if(r&&!he.test(r))throw new TypeError("argument val is invalid");let o=s+"="+r;if(n.maxAge!=null){const c=n.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(c)}if(n.domain){if(!he.test(n.domain))throw new TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!he.test(n.path))throw new TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){if(!function(l){return Object.prototype.toString.call(l)==="[object Date]"||l instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Nt(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function Dt(s){return encodeURIComponent(s)}let et;function pe(s){if(s)try{const e=decodeURIComponent(et(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function tt(s,e=0){let t=pe(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}et=typeof atob=="function"?atob:s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,i=0,r=0,o="";n=e.charAt(r++);~n&&(t=i%4?64*t+n:n,i++%4)?o+=String.fromCharCode(255&t>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};const Ke="pb_auth";class Ft{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!tt(this.token)}get isAdmin(){return pe(this.token).type==="admin"}get isAuthRecord(){return pe(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Ke){const n=Ut(e||"")[t]||"";let i={};try{i=JSON.parse(n),(typeof i===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.model||null)}exportToCookie(e,t=Ke){const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},i=pe(this.token);n.expires=i?.exp?new Date(1e3*i.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const r={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let o=Fe(t,JSON.stringify(r),e);const c=typeof Blob<"u"?new Blob([o]).size:o.length;if(r.model&&c>4096){r.model={id:r?.model?.id,email:r?.model?.email};const l=["collectionId","username","verified"];for(const a in this.model)l.includes(a)&&(r.model[a]=this.model[a]);o=Fe(t,JSON.stringify(r),e)}return o}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class Kt extends Ft{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&window?.localStorage){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&window?.localStorage){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){typeof window<"u"&&window?.localStorage&&window.localStorage?.removeItem(e),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&window?.localStorage&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class G{constructor(e){this.client=e}}class Bt extends G{getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}testEmail(e,t,n){return n=Object.assign({method:"POST",body:{email:e,template:t}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}generateAppleClientSecret(e,t,n,i,r,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:i,duration:r}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}class Ie extends G{decode(e){return e}getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(i=>(i.items=i.items?.map(r=>this.decode(r))||[],i))}getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{if(!n?.items?.length)throw new D({status:404,data:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}getOne(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(i=>this.decode(i))}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],i=async r=>this.getList(r,e||500,t).then(o=>{const c=o.items;return n=n.concat(c),c.length==o.perPage?i(r+1):n});return i(1)}}function U(s,e,t,n){const i=n!==void 0;return i||t!==void 0?i?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function Ce(s){s._resetAutoRefresh?.()}class Mt extends Ie{get baseCrudPath(){return"/api/admins"}update(e,t,n){return super.update(e,t,n).then(i=>(this.client.authStore.model?.id===i.id&&this.client.authStore.model?.collectionId===void 0&&this.client.authStore.save(this.client.authStore.token,i),i))}delete(e,t){return super.delete(e,t).then(n=>(n&&this.client.authStore.model?.id===e&&this.client.authStore.model?.collectionId===void 0&&this.client.authStore.clear(),n))}authResponse(e){const t=this.decode(e?.admin||{});return e?.token&&e?.admin&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:e?.token||"",admin:t})}async authWithPassword(e,t,n,i){let r={method:"POST",body:{identity:e,password:t}};r=U("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",r,n,i);const o=r.autoRefreshThreshold;delete r.autoRefreshThreshold,r.autoRefresh||Ce(this.client);let c=await this.client.send(this.baseCrudPath+"/auth-with-password",r);return c=this.authResponse(c),o&&function(a,u,h,f){Ce(a);const d=a.beforeSend,m=a.authStore.model,b=a.authStore.onChange((v,y)=>{(!v||y?.id!=m?.id||(y?.collectionId||m?.collectionId)&&y?.collectionId!=m?.collectionId)&&Ce(a)});a._resetAutoRefresh=function(){b(),a.beforeSend=d,delete a._resetAutoRefresh},a.beforeSend=async(v,y)=>{const P=a.authStore.token;if(y.query?.autoRefresh)return d?d(v,y):{url:v,sendOptions:y};let w=a.authStore.isValid;if(w&&tt(a.authStore.token,u))try{await h()}catch{w=!1}w||await f();const I=y.headers||{};for(let x in I)if(x.toLowerCase()=="authorization"&&P==I[x]&&a.authStore.token){I[x]=a.authStore.token;break}return y.headers=I,d?d(v,y):{url:v,sendOptions:y}}}(this.client,o,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},r))),c}authRefresh(e,t){let n={method:"POST"};return n=U("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",n).then(this.authResponse.bind(this))}requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=U("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCrudPath+"/request-password-reset",i).then(()=>!0)}confirmPasswordReset(e,t,n,i,r){let o={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return o=U("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",o,i,r),this.client.send(this.baseCrudPath+"/confirm-password-reset",o).then(()=>!0)}}const Wt=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function nt(s){if(s){s.query=s.query||{};for(let e in s)Wt.includes(e)||(s.query[e]=s[e],delete s[e])}}class st extends G{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){if(!e)throw new Error("topic must be set.");let i=e;if(n){nt(n);const o="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));i+=(i.includes("?")?"&":"?")+o}const r=function(o){const c=o;let l;try{l=JSON.parse(c?.data)}catch{}t(l||{})};return this.subscriptions[i]||(this.subscriptions[i]=[]),this.subscriptions[i].push(r),this.isConnected?this.subscriptions[i].length===1?await this.submitSubscriptions():this.eventSource?.addEventListener(i,r):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,r)}async unsubscribe(e){let t=!1;if(e){const n=this.getSubscriptionsByTopic(e);for(let i in n)if(this.hasSubscriptionListeners(i)){for(let r of this.subscriptions[i])this.eventSource?.removeEventListener(i,r);delete this.subscriptions[i],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){let t=!1;for(let n in this.subscriptions)if((n+"?").startsWith(e)){t=!0;for(let i of this.subscriptions[n])this.eventSource?.removeEventListener(n,i);delete this.subscriptions[n]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){let n=!1;const i=this.getSubscriptionsByTopic(e);for(let r in i){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let o=!1;for(let c=this.subscriptions[r].length-1;c>=0;c--)this.subscriptions[r][c]===t&&(o=!0,delete this.subscriptions[r][c],this.subscriptions[r].splice(c,1),this.eventSource?.removeEventListener(r,t));o&&(this.subscriptions[r].length||delete this.subscriptions[r],n||this.hasSubscriptionListeners(r)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){if(this.subscriptions=this.subscriptions||{},e)return!!this.subscriptions[e]?.length;for(let t in this.subscriptions)if(this.subscriptions[t]?.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!e?.isAbort)throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t?.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let i in n)for(let r of n[i])r(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new D(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),this.eventSource?.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let t of this.pendingConnects)t.resolve();this.pendingConnects=[]}}}class Ht extends Ie{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}getList(e=1,t=30,n){return super.getList(e,t,n)}getFirstListItem(e,t){return super.getFirstListItem(e,t)}getOne(e,t){return super.getOne(e,t)}create(e,t){return super.create(e,t)}update(e,t,n){return super.update(e,t,n).then(i=>(this.client.authStore.model?.id!==i?.id||this.client.authStore.model?.collectionId!==this.collectionIdOrName&&this.client.authStore.model?.collectionName!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,i),i))}delete(e,t){return super.delete(e,t).then(n=>(!n||this.client.authStore.model?.id!==e||this.client.authStore.model?.collectionId!==this.collectionIdOrName&&this.client.authStore.model?.collectionName!==this.collectionIdOrName||this.client.authStore.clear(),n))}authResponse(e){const t=this.decode(e?.record||{});return this.client.authStore.save(e?.token,t),Object.assign({},e,{token:e?.token||"",record:t})}listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!t?.usernamePassword,emailPassword:!!t?.emailPassword,authProviders:Array.isArray(t?.authProviders)?t?.authProviders:[]}))}authWithPassword(e,t,n,i){let r={method:"POST",body:{identity:e,password:t}};return r=U("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",r,n,i),this.client.send(this.baseCollectionPath+"/auth-with-password",r).then(o=>this.authResponse(o))}authWithOAuth2Code(e,t,n,i,r,o,c){let l={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectUrl:i,createData:r}};return l=U("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",l,o,c),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",l).then(a=>this.authResponse(a))}async authWithOAuth2(...e){if(e.length>1||typeof e?.[0]=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code(e?.[0]||"",e?.[1]||"",e?.[2]||"",e?.[3]||"",e?.[4]||{},e?.[5]||{},e?.[6]||{});const t=e?.[0]||{},n=(await this.listAuthMethods()).authProviders.find(l=>l.name===t.provider);if(!n)throw new D(new Error(`Missing or invalid provider "${t.provider}".`));const i=this.client.buildUrl("/api/oauth2-redirect"),r=new st(this.client);let o=null;function c(){o?.close(),r.unsubscribe()}return t.urlCallback||(o=Be(void 0)),new Promise(async(l,a)=>{try{await r.subscribe("@oauth2",async d=>{const m=r.clientId;try{if(!d.state||m!==d.state)throw new Error("State parameters don't match.");const b=Object.assign({},t);delete b.provider,delete b.scopes,delete b.createData,delete b.urlCallback;const v=await this.authWithOAuth2Code(n.name,d.code,n.codeVerifier,i,t.createData,b);l(v)}catch(b){a(new D(b))}c()});const u={state:r.clientId};t.scopes?.length&&(u.scope=t.scopes.join(" "));const h=this._replaceQueryParams(n.authUrl+i,u);await(t.urlCallback||function(d){o?o.location.href=d:o=Be(d)})(h)}catch(u){c(),a(new D(u))}})}authRefresh(e,t){let n={method:"POST"};return n=U("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(i=>this.authResponse(i))}requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=U("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",i).then(()=>!0)}confirmPasswordReset(e,t,n,i,r){let o={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return o=U("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,i,r),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}requestVerification(e,t,n){let i={method:"POST",body:{email:e}};return i=U("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-verification",i).then(()=>!0)}confirmVerification(e,t,n){let i={method:"POST",body:{token:e}};return i=U("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",i).then(()=>!0)}requestEmailChange(e,t,n){let i={method:"POST",body:{newEmail:e}};return i=U("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",i).then(()=>!0)}confirmEmailChange(e,t,n,i){let r={method:"POST",body:{token:e,password:t}};return r=U("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",r,n,i),this.client.send(this.baseCollectionPath+"/confirm-email-change",r).then(()=>!0)}listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}unlinkExternalAuth(e,t,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),n).then(()=>!0)}_replaceQueryParams(e,t={}){let n=e,i="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),i=e.substring(e.indexOf("?")+1));const r={},o=i.split("&");for(const c of o){if(c=="")continue;const l=c.split("=");r[decodeURIComponent(l[0].replace(/\+/g," "))]=decodeURIComponent((l[1]||"").replace(/\+/g," "))}for(let c in t)t.hasOwnProperty(c)&&(t[c]==null?delete r[c]:r[c]=t[c]);i="";for(let c in r)r.hasOwnProperty(c)&&(i!=""&&(i+="&"),i+=encodeURIComponent(c.replace(/%20/g,"+"))+"="+encodeURIComponent(r[c].replace(/%20/g,"+")));return i!=""?n+"?"+i:n}}function Be(s){if(typeof window>"u"||!window?.open)throw new D(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,i=window.innerHeight;e=e>n?n:e,t=t>i?i:t;let r=n/2-e/2,o=i/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+o+",left="+r+",resizable,menubar=no")}class Vt extends Ie{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}}class Gt extends G{getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}getOne(e,t){return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class zt extends G{check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Jt extends G{getUrl(e,t,n={}){if(!t||!e?.id||!e?.collectionId&&!e?.collectionName)return"";const i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(e.collectionId||e.collectionName)),i.push(encodeURIComponent(e.id)),i.push(encodeURIComponent(t));let r=this.client.buildUrl(i.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const o=new URLSearchParams(n);r+=(r.includes("?")?"&":"?")+o}return r}getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>t?.token||"")}}class Qt extends G{getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class Yt{constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=n,this.authStore=t||new Kt,this.admins=new Mt(this),this.collections=new Vt(this),this.files=new Jt(this),this.logs=new Gt(this),this.settings=new Bt(this),this.realtime=new st(this),this.health=new zt(this),this.backups=new Qt(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Ht(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let i=t[n];switch(typeof i){case"boolean":case"number":i=""+i;break;case"string":i="'"+i.replace(/'/g,"\\'")+"'";break;default:i=i===null?"null":i instanceof Date?"'"+i.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(i).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",i)}return e}getFileUrl(e,t,n={}){return this.files.getUrl(e,t,n)}buildUrl(e){let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=window.location.origin?.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildUrl(e);if(this.beforeSend){const i=Object.assign({},await this.beforeSend(n,t));i.url!==void 0||i.options!==void 0?(n=i.url||n,t=i.options||t):Object.keys(i).length&&(t=i,console?.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const i=this.serializeQueryParams(t.query);i&&(n+=(n.includes("?")?"&":"?")+i),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async i=>{let r={};try{r=await i.json()}catch{}if(this.afterSend&&(r=await this.afterSend(i,r)),i.status>=400)throw new D({url:i.url,status:i.status,data:r});return r}).catch(i=>{throw new D(i)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),nt(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const i=new AbortController;this.cancelControllers[n]=i,t.signal=i.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(let n in e){const i=Array.isArray(e[n])?e[n]:[e[n]];for(let r of i)t.append(n,r)}return t}hasBlobField(e){for(let t in e){const n=Array.isArray(e[t])?e[t]:[e[t]];for(let i of n)if(typeof Blob<"u"&&i instanceof Blob||typeof File<"u"&&i instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const n in e){if(e[n]===null)continue;const i=e[n],r=encodeURIComponent(n);if(Array.isArray(i))for(const o of i)t.push(r+"="+encodeURIComponent(o));else i instanceof Date?t.push(r+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?t.push(r+"="+encodeURIComponent(JSON.stringify(i))):t.push(r+"="+encodeURIComponent(i))}return t.join("&")}}const J=[];function it(s,e=E){let t;const n=new Set;function i(c){if(te(s,c)&&(s=c,t)){const l=!J.length;for(const a of n)a[1](),J.push(a,s);if(l){for(let a=0;a<J.length;a+=2)J[a][0](J[a+1]);J.length=0}}}function r(c){i(c(s))}function o(c,l=E){const a=[c,l];return n.add(a),n.size===1&&(t=e(i,r)||E),c(s),()=>{n.delete(a),n.size===0&&t&&(t(),t=null)}}return{set:i,update:r,subscribe:o}}const F=new Yt("https://endless-struggle.pockethost.io/"),xe=it(F.authStore.model);F.authStore.onChange(s=>{xe.set(F.authStore.model)});function Xt(s){let e,t,n,i,r,o,c="Sign in",l,a,u,h;return{c(){e=S("form"),t=S("input"),n=j(),i=S("input"),r=j(),o=S("button"),o.textContent=c,l=j(),a=S("input"),this.h()},l(f){e=C(f,"FORM",{});var d=A(e);t=C(d,"INPUT",{type:!0,placeholder:!0}),n=q(d),i=C(d,"INPUT",{type:!0,placeholder:!0}),r=q(d),o=C(d,"BUTTON",{"data-svelte-h":!0}),V(o)!=="svelte-m4mqwt"&&(o.textContent=c),l=q(d),a=C(d,"INPUT",{type:!0}),d.forEach(g),this.h()},h(){O(t,"type","text"),O(t,"placeholder","username"),t.required=!0,O(i,"type","password"),O(i,"placeholder","password"),i.required=!0,O(a,"type","submit"),a.value="Sign up"},m(f,d){$(f,e,d),_(e,t),Y(t,s[0]),_(e,n),_(e,i),Y(i,s[1]),_(e,r),_(e,o),_(e,l),_(e,a),u||(h=[K(t,"input",s[5]),K(i,"input",s[6]),K(o,"click",s[2]),K(a,"click",s[3]),K(e,"submit",Qe(s[4]))],u=!0)},p(f,[d]){d&1&&t.value!==f[0]&&Y(t,f[0]),d&2&&i.value!==f[1]&&Y(i,f[1])},i:E,o:E,d(f){f&&g(e),u=!1,M(h)}}}function Zt(s,e,t){let n,i;async function r(){if(!(n===void 0||i===void 0))try{const h=await F.collection("users").authWithPassword(n,i);c()}catch(h){console.log(h)}}async function o(){if(!(n===void 0||i===void 0))try{const h={username:n,password:i,passwordConfirm:i,name:n,role:"user"},f=await F.collection("users").create(h);await r(),c()}catch(h){console.log(h)}}function c(){t(0,n=""),t(1,i="")}function l(h){Ot.call(this,s,h)}function a(){n=this.value,t(0,n)}function u(){i=this.value,t(1,i)}return[n,i,r,o,l,a,u]}class en extends le{constructor(e){super(),ce(this,e,Zt,Xt,te,{})}}function tn(s){let e,t="Log out",n,i;return{c(){e=S("button"),e.textContent=t},l(r){e=C(r,"BUTTON",{"data-svelte-h":!0}),V(e)!=="svelte-vmi6ig"&&(e.textContent=t)},m(r,o){$(r,e,o),n||(i=K(e,"click",s[0]),n=!0)},p:E,i:E,o:E,d(r){r&&g(e),n=!1,i()}}}function nn(s){function e(){F.authStore.clear()}return[e]}class sn extends le{constructor(e){super(),ce(this,e,nn,tn,te,{})}}function rn(s,{delay:e=0,duration:t=400,easing:n=He}={}){const i=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:n,css:r=>`opacity: ${r*i}`}}const de=it([]);function Me(s,e,t){const n=s.slice();return n[6]=e[t],n}function We(s,e){let t,n,i,r,o,c,l,a,u=e[6].expand?.author?.name+"",h,f,d,m=e[6].text+"",b,v,y;return{key:s,first:null,c(){t=S("li"),n=S("div"),i=S("img"),o=j(),c=S("div"),l=S("div"),a=H("@"),h=H(u),f=j(),d=S("div"),b=H(m),v=j(),this.h()},l(P){t=C(P,"LI",{class:!0});var w=A(t);n=C(w,"DIV",{class:!0});var I=A(n);i=C(I,"IMG",{src:!0,alt:!0}),I.forEach(g),o=q(w),c=C(w,"DIV",{class:!0});var x=A(c);l=C(x,"DIV",{class:!0});var R=A(l);a=Z(R,"@"),h=Z(R,u),R.forEach(g),f=q(x),d=C(x,"DIV",{class:!0});var T=A(d);b=Z(T,m),T.forEach(g),x.forEach(g),v=q(w),w.forEach(g),this.h()},h(){Ae(i.src,r=`https://api.dicebear.com/7.x/icons/svg?backgroundColor=b6e3f4,c0aede,d1d4f9&backgroundType=gradientLinear&seed=${e[6].expand?.author?.name}`)||O(i,"src",r),O(i,"alt",""),O(n,"class","message-image svelte-18ejakj"),O(l,"class","author"),O(d,"class","content"),O(c,"class","message-body svelte-18ejakj"),O(t,"class","message svelte-18ejakj"),this.first=t},m(P,w){$(P,t,w),_(t,n),_(n,i),_(t,o),_(t,c),_(c,l),_(l,a),_(l,h),_(c,f),_(c,d),_(d,b),_(t,v)},p(P,w){e=P,w&2&&!Ae(i.src,r=`https://api.dicebear.com/7.x/icons/svg?backgroundColor=b6e3f4,c0aede,d1d4f9&backgroundType=gradientLinear&seed=${e[6].expand?.author?.name}`)&&O(i,"src",r),w&2&&u!==(u=e[6].expand?.author?.name+"")&&ke(h,u),w&2&&m!==(m=e[6].text+"")&&ke(b,m)},i(P){P&&(y||re(()=>{y=Rt(t,rn,{duration:240}),y.start()}))},o:E,d(P){P&&g(t)}}}function on(s){let e,t,n=[],i=new Map,r,o,c=De(s[1]);const l=a=>a[6].id;for(let a=0;a<c.length;a+=1){let u=Me(s,c,a),h=l(u);i.set(h,n[a]=We(h,u))}return{c(){e=S("div"),t=S("ul");for(let a=0;a<n.length;a+=1)n[a].c();r=j(),o=S("div"),this.h()},l(a){e=C(a,"DIV",{class:!0});var u=A(e);t=C(u,"UL",{class:!0});var h=A(t);for(let f=0;f<n.length;f+=1)n[f].l(h);h.forEach(g),r=q(u),o=C(u,"DIV",{id:!0}),A(o).forEach(g),u.forEach(g),this.h()},h(){O(t,"class","svelte-18ejakj"),O(o,"id","bottom"),O(e,"class","message-list shadow-md svelte-18ejakj")},m(a,u){$(a,e,u),_(e,t);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(t,null);_(e,r),_(e,o),s[2](o)},p(a,[u]){u&2&&(c=De(a[1]),n=jt(n,u,l,1,a,c,i,t,At,We,null,Me))},i(a){for(let u=0;u<c.length;u+=1)N(n[u])},o:E,d(a){a&&g(e);for(let u=0;u<n.length;u+=1)n[u].d();s[2](null)}}}function an(s,e,t){let n;Pe(s,de,a=>t(1,n=a));let i=()=>{},r;Ct(async()=>{const a=await F.collection("posts").getList(1,50,{sort:"created",expand:"author"});Se(de,n=a.items,n),i=await F.collection("posts").subscribe("*",o),c()}),kt(async()=>{i()});async function o({action:a,record:u}){if(a==="create"){const h=await F.collection("users").getOne(u.author);u.expand={author:h},Se(de,n=[...n,u],n),c()}a==="delete"&&Se(de,n=n.filter(h=>h.id!==u.id),n)}function c(){setTimeout(()=>{r.scrollIntoView({behavior:"auto"})},10)}function l(a){Oe[a?"unshift":"push"](()=>{r=a,t(0,r)})}return[r,n,l]}class cn extends le{constructor(e){super(),ce(this,e,an,on,te,{})}}function ln(s){let e,t,n,i,r,o;return{c(){e=S("form"),t=S("input"),n=j(),i=S("input"),this.h()},l(c){e=C(c,"FORM",{});var l=A(e);t=C(l,"INPUT",{type:!0,placeholder:!0}),n=q(l),i=C(l,"INPUT",{type:!0}),l.forEach(g),this.h()},h(){O(t,"type","text"),O(t,"placeholder","post..."),t.required=!0,O(i,"type","submit")},m(c,l){$(c,e,l),_(e,t),Y(t,s[0]),_(e,n),_(e,i),r||(o=[K(t,"input",s[2]),K(e,"submit",Qe(s[1]))],r=!0)},p(c,[l]){l&1&&t.value!==c[0]&&Y(t,c[0])},i:E,o:E,d(c){c&&g(e),r=!1,M(o)}}}function un(s,e,t){let n;Pe(s,xe,c=>t(3,n=c));let i="";async function r(){if(i==="")return;const c=i;t(0,i="");const l={text:c,author:n?.id};await F.collection("posts").create(l)}function o(){i=this.value,t(0,i)}return[i,r,o]}class hn extends le{constructor(e){super(),ce(this,e,un,ln,te,{})}}function dn(s){let e,t;return e=new en({}),{c(){ge(e.$$.fragment)},l(n){ye(e.$$.fragment,n)},m(n,i){oe(e,n,i),t=!0},p:E,i(n){t||(N(e.$$.fragment,n),t=!0)},o(n){B(e.$$.fragment,n),t=!1},d(n){ae(e,n)}}}function fn(s){let e,t,n=s[0].username+"",i,r,o,c;return o=new sn({}),{c(){e=S("p"),t=H("Hello, "),i=H(n),r=j(),ge(o.$$.fragment)},l(l){e=C(l,"P",{});var a=A(e);t=Z(a,"Hello, "),i=Z(a,n),a.forEach(g),r=q(l),ye(o.$$.fragment,l)},m(l,a){$(l,e,a),_(e,t),_(e,i),$(l,r,a),oe(o,l,a),c=!0},p(l,a){(!c||a&1)&&n!==(n=l[0].username+"")&&ke(i,n)},i(l){c||(N(o.$$.fragment,l),c=!0)},o(l){B(o.$$.fragment,l),c=!1},d(l){l&&(g(e),g(r)),ae(o,l)}}}function pn(s){let e,t="Sign in to continue";return{c(){e=S("p"),e.textContent=t},l(n){e=C(n,"P",{"data-svelte-h":!0}),V(e)!=="svelte-tm058q"&&(e.textContent=t)},m(n,i){$(n,e,i)},i:E,o:E,d(n){n&&g(e)}}}function mn(s){let e,t,n,i,r="Send a post",o,c,l;return t=new cn({}),c=new hn({}),{c(){e=S("div"),ge(t.$$.fragment),n=j(),i=S("p"),i.textContent=r,o=j(),ge(c.$$.fragment),this.h()},l(a){e=C(a,"DIV",{class:!0});var u=A(e);ye(t.$$.fragment,u),u.forEach(g),n=q(a),i=C(a,"P",{"data-svelte-h":!0}),V(i)!=="svelte-ummdzd"&&(i.textContent=r),o=q(a),ye(c.$$.fragment,a),this.h()},h(){O(e,"class","message-container")},m(a,u){$(a,e,u),oe(t,e,null),$(a,n,u),$(a,i,u),$(a,o,u),oe(c,a,u),l=!0},i(a){l||(N(t.$$.fragment,a),N(c.$$.fragment,a),l=!0)},o(a){B(t.$$.fragment,a),B(c.$$.fragment,a),l=!1},d(a){a&&(g(e),g(n),g(i),g(o)),ae(t),ae(c,a)}}}function bn(s){let e,t,n="Endless Struggle",i,r,o,c,l,a,u="Epic app",h,f,d,m,b,v="<p>Epic footer</p>",y;const P=[fn,dn],w=[];function I(p,k){return p[0]?0:1}r=I(s),o=w[r]=P[r](s);const x=[mn,pn],R=[];function T(p,k){return p[0]?0:1}return f=T(s),d=R[f]=x[f](s),{c(){e=S("header"),t=S("h1"),t.textContent=n,i=j(),o.c(),c=j(),l=S("main"),a=S("h1"),a.textContent=u,h=j(),d.c(),m=j(),b=S("footer"),b.innerHTML=v,this.h()},l(p){e=C(p,"HEADER",{class:!0});var k=A(e);t=C(k,"H1",{class:!0,"data-svelte-h":!0}),V(t)!=="svelte-14t5sun"&&(t.textContent=n),i=q(k),o.l(k),k.forEach(g),c=q(p),l=C(p,"MAIN",{class:!0});var L=A(l);a=C(L,"H1",{class:!0,"data-svelte-h":!0}),V(a)!=="svelte-10y9afe"&&(a.textContent=u),h=q(L),d.l(L),L.forEach(g),m=q(p),b=C(p,"FOOTER",{class:!0,"data-svelte-h":!0}),V(b)!=="svelte-nqa6xf"&&(b.innerHTML=v),this.h()},h(){O(t,"class","svelte-1jak59n"),O(e,"class","svelte-1jak59n"),O(a,"class","svelte-1jak59n"),O(l,"class","svelte-1jak59n"),O(b,"class","svelte-1jak59n")},m(p,k){$(p,e,k),_(e,t),_(e,i),w[r].m(e,null),$(p,c,k),$(p,l,k),_(l,a),_(l,h),R[f].m(l,null),$(p,m,k),$(p,b,k),y=!0},p(p,[k]){let L=r;r=I(p),r===L?w[r].p(p,k):(Ue(),B(w[L],1,1,()=>{w[L]=null}),Ne(),o=w[r],o?o.p(p,k):(o=w[r]=P[r](p),o.c()),N(o,1),o.m(e,null));let _e=f;f=T(p),f!==_e&&(Ue(),B(R[_e],1,1,()=>{R[_e]=null}),Ne(),d=R[f],d||(d=R[f]=x[f](p),d.c()),N(d,1),d.m(l,null))},i(p){y||(N(o),N(d),y=!0)},o(p){B(o),B(d),y=!1},d(p){p&&(g(e),g(c),g(l),g(m),g(b)),w[r].d(),R[f].d()}}}function gn(s,e,t){let n;return Pe(s,xe,i=>t(0,n=i)),[n]}class wn extends le{constructor(e){super(),ce(this,e,gn,bn,te,{})}}export{wn as default};
