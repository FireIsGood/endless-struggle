/* empty css                       */function x(){}const Ve=s=>s;function We(s){return s()}function Re(){return Object.create(null)}function K(s){s.forEach(We)}function Te(s){return typeof s=="function"}function G(s,e){return s!=s?e==e:s!==e||s&&typeof s=="object"||typeof s=="function"}let de;function qe(s,e){return s===e?!0:(de||(de=document.createElement("a")),de.href=e,s===de.href)}function ot(s){return Object.keys(s).length===0}function at(s,...e){if(s==null){for(const n of e)n(void 0);return x}const t=s.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Pe(s,e,t){s.$$.on_destroy.push(at(e,t))}function _e(s,e,t){return s.set(t),e}const He=typeof window<"u";let lt=He?()=>window.performance.now():()=>Date.now(),Ie=He?s=>requestAnimationFrame(s):x;const ee=new Set;function Ge(s){ee.forEach(e=>{e.c(s)||(ee.delete(e),e.f())}),ee.size!==0&&Ie(Ge)}function ct(s){let e;return ee.size===0&&Ie(Ge),{promise:new Promise(t=>{ee.add(e={c:s,f:t})}),abort(){ee.delete(e)}}}let we=!1;function ut(){we=!0}function ht(){we=!1}function dt(s,e,t,n){for(;s<e;){const i=s+(e-s>>1);t(i)<=n?s=i+1:e=i}return s}function ft(s){if(s.hydrate_init)return;s.hydrate_init=!0;let e=s.childNodes;if(s.nodeName==="HEAD"){const c=[];for(let a=0;a<e.length;a++){const h=e[a];h.claim_order!==void 0&&c.push(h)}e=c}const t=new Int32Array(e.length+1),n=new Int32Array(e.length);t[0]=-1;let i=0;for(let c=0;c<e.length;c++){const a=e[c].claim_order,h=(i>0&&e[t[i]].claim_order<=a?i+1:dt(1,i,p=>e[t[p]].claim_order,a))-1;n[c]=t[h]+1;const u=h+1;t[u]=c,i=Math.max(u,i)}const r=[],o=[];let l=e.length-1;for(let c=t[i]+1;c!=0;c=n[c-1]){for(r.push(e[c-1]);l>=c;l--)o.push(e[l]);l--}for(;l>=0;l--)o.push(e[l]);r.reverse(),o.sort((c,a)=>c.claim_order-a.claim_order);for(let c=0,a=0;c<o.length;c++){for(;a<r.length&&o[c].claim_order>=r[a].claim_order;)a++;const h=a<r.length?r[a]:null;s.insertBefore(o[c],h)}}function pt(s,e){s.appendChild(e)}function Je(s){if(!s)return document;const e=s.getRootNode?s.getRootNode():s.ownerDocument;return e&&e.host?e:s.ownerDocument}function mt(s){const e=O("style");return e.textContent="/* empty */",gt(Je(s),e),e.sheet}function gt(s,e){return pt(s.head||s,e),e.sheet}function y(s,e){if(we){for(ft(s),(s.actual_end_child===void 0||s.actual_end_child!==null&&s.actual_end_child.parentNode!==s)&&(s.actual_end_child=s.firstChild);s.actual_end_child!==null&&s.actual_end_child.claim_order===void 0;)s.actual_end_child=s.actual_end_child.nextSibling;e!==s.actual_end_child?(e.claim_order!==void 0||e.parentNode!==s)&&s.insertBefore(e,s.actual_end_child):s.actual_end_child=e.nextSibling}else(e.parentNode!==s||e.nextSibling!==null)&&s.appendChild(e)}function A(s,e,t){we&&!t?y(s,e):(e.parentNode!==s||e.nextSibling!=t)&&s.insertBefore(e,t||null)}function _(s){s.parentNode&&s.parentNode.removeChild(s)}function O(s){return document.createElement(s)}function z(s){return document.createTextNode(s)}function P(){return z(" ")}function B(s,e,t,n){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t,n)}function Qe(s){return function(e){return e.preventDefault(),s.call(this,e)}}function w(s,e,t){t==null?s.removeAttribute(e):s.getAttribute(e)!==t&&s.setAttribute(e,t)}function V(s){return s.dataset.svelteH}function E(s){return Array.from(s.childNodes)}function bt(s){s.claim_info===void 0&&(s.claim_info={last_index:0,total_claimed:0})}function Ye(s,e,t,n,i=!1){bt(s);const r=(()=>{for(let o=s.claim_info.last_index;o<s.length;o++){const l=s[o];if(e(l)){const c=t(l);return c===void 0?s.splice(o,1):s[o]=c,i||(s.claim_info.last_index=o),l}}for(let o=s.claim_info.last_index-1;o>=0;o--){const l=s[o];if(e(l)){const c=t(l);return c===void 0?s.splice(o,1):s[o]=c,i?c===void 0&&s.claim_info.last_index--:s.claim_info.last_index=o,l}}return n()})();return r.claim_order=s.claim_info.total_claimed,s.claim_info.total_claimed+=1,r}function yt(s,e,t,n){return Ye(s,i=>i.nodeName===e,i=>{const r=[];for(let o=0;o<i.attributes.length;o++){const l=i.attributes[o];t[l.name]||r.push(l.name)}r.forEach(o=>i.removeAttribute(o))},()=>n(e))}function k(s,e,t){return yt(s,e,t,O)}function te(s,e){return Ye(s,t=>t.nodeType===3,t=>{const n=""+e;if(t.data.startsWith(n)){if(t.data.length!==n.length)return t.splitText(n.length)}else t.data=n},()=>z(e),!0)}function I(s){return te(s," ")}function Ce(s,e){e=""+e,s.data!==e&&(s.data=e)}function Z(s,e){s.value=e??""}function wt(s,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:n})}const be=new Map;let ye=0;function _t(s){let e=5381,t=s.length;for(;t--;)e=(e<<5)-e^s.charCodeAt(t);return e>>>0}function vt(s,e){const t={stylesheet:mt(e),rules:{}};return be.set(s,t),t}function St(s,e,t,n,i,r,o,l=0){const c=16.666/n;let a=`{
`;for(let b=0;b<=1;b+=c){const v=e+(t-e)*r(b);a+=b*100+`%{${o(v,1-v)}}
`}const h=a+`100% {${o(t,1-t)}}
}`,u=`__svelte_${_t(h)}_${l}`,p=Je(s),{stylesheet:f,rules:d}=be.get(p)||vt(p,s);d[u]||(d[u]=!0,f.insertRule(`@keyframes ${u} ${h}`,f.cssRules.length));const C=s.style.animation||"";return s.style.animation=`${C?`${C}, `:""}${u} ${n}ms linear ${i}ms 1 both`,ye+=1,u}function je(s,e){const t=(s.style.animation||"").split(", "),n=t.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),i=t.length-n.length;i&&(s.style.animation=n.join(", "),ye-=i,ye||Ct())}function Ct(){Ie(()=>{ye||(be.forEach(s=>{const{ownerNode:e}=s.stylesheet;e&&_(e)}),be.clear())})}let ce;function le(s){ce=s}function Xe(){if(!ce)throw new Error("Function called outside component initialization");return ce}function Ot(s){Xe().$$.on_mount.push(s)}function kt(s){Xe().$$.on_destroy.push(s)}function Et(s,e){const t=s.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const X=[],Oe=[];let ne=[];const Le=[],$t=Promise.resolve();let ke=!1;function Tt(){ke||(ke=!0,$t.then(Ze))}function ue(s){ne.push(s)}const ve=new Set;let Q=0;function Ze(){if(Q!==0)return;const s=ce;do{try{for(;Q<X.length;){const e=X[Q];Q++,le(e),Pt(e.$$)}}catch(e){throw X.length=0,Q=0,e}for(le(null),X.length=0,Q=0;Oe.length;)Oe.pop()();for(let e=0;e<ne.length;e+=1){const t=ne[e];ve.has(t)||(ve.add(t),t())}ne.length=0}while(X.length);for(;Le.length;)Le.pop()();ke=!1,ve.clear(),le(s)}function Pt(s){if(s.fragment!==null){s.update(),K(s.before_update);const e=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,e),s.after_update.forEach(ue)}}function It(s){const e=[],t=[];ne.forEach(n=>s.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),ne=e}let ae;function xt(){return ae||(ae=Promise.resolve(),ae.then(()=>{ae=null})),ae}function Ue(s,e,t){s.dispatchEvent(wt(`${e?"intro":"outro"}${t}`))}const me=new Set;let M;function Ee(){M={r:0,c:[],p:M}}function $e(){M.r||K(M.c),M=M.p}function R(s,e){s&&s.i&&(me.delete(s),s.i(e))}function L(s,e,t,n){if(s&&s.o){if(me.has(s))return;me.add(s),M.c.push(()=>{me.delete(s),n&&(t&&s.d(1),n())}),s.o(e)}else n&&n()}const At={duration:0};function Rt(s,e,t){const n={direction:"in"};let i=e(s,t,n),r=!1,o,l,c=0;function a(){o&&je(s,o)}function h(){const{delay:p=0,duration:f=300,easing:d=Ve,tick:C=x,css:b}=i||At;b&&(o=St(s,0,1,f,p,d,b,c++)),C(0,1);const v=lt()+p,m=v+f;l&&l.abort(),r=!0,ue(()=>Ue(s,!0,"start")),l=ct(g=>{if(r){if(g>=m)return C(1,0),Ue(s,!0,"end"),a(),r=!1;if(g>=v){const S=d((g-v)/f);C(S,1-S)}}return r})}let u=!1;return{start(){u||(u=!0,je(s),Te(i)?(i=i(n),xt().then(h)):h())},invalidate(){u=!1},end(){r&&(a(),r=!1)}}}function Ne(s){return s?.length!==void 0?s:Array.from(s)}function qt(s,e){L(s,1,1,()=>{e.delete(s.key)})}function jt(s,e,t,n,i,r,o,l,c,a,h,u){let p=s.length,f=r.length,d=p;const C={};for(;d--;)C[s[d].key]=d;const b=[],v=new Map,m=new Map,g=[];for(d=f;d--;){const $=u(i,r,d),N=t($);let D=o.get(N);D?n&&g.push(()=>D.p($,e)):(D=a(N,$),D.c()),v.set(N,b[d]=D),N in C&&m.set(N,Math.abs(d-C[N]))}const S=new Set,T=new Set;function j($){R($,1),$.m(l,h),o.set($.key,$),h=$.first,f--}for(;p&&f;){const $=b[f-1],N=s[p-1],D=$.key,he=N.key;$===N?(h=$.first,p--,f--):v.has(he)?!o.has(D)||S.has(D)?j($):T.has(he)?p--:m.get(D)>m.get(he)?(T.add(D),j($)):(S.add(he),p--):(c(N,o),p--)}for(;p--;){const $=s[p];v.has($.key)||c($,o)}for(;f;)j(b[f-1]);return K(g),b}function se(s){s&&s.c()}function ie(s,e){s&&s.l(e)}function W(s,e,t){const{fragment:n,after_update:i}=s.$$;n&&n.m(e,t),ue(()=>{const r=s.$$.on_mount.map(We).filter(Te);s.$$.on_destroy?s.$$.on_destroy.push(...r):K(r),s.$$.on_mount=[]}),i.forEach(ue)}function H(s,e){const t=s.$$;t.fragment!==null&&(It(t.after_update),K(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Lt(s,e){s.$$.dirty[0]===-1&&(X.push(s),Tt(),s.$$.dirty.fill(0)),s.$$.dirty[e/31|0]|=1<<e%31}function re(s,e,t,n,i,r,o=null,l=[-1]){const c=ce;le(s);const a=s.$$={fragment:null,ctx:[],props:r,update:x,not_equal:i,bound:Re(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Re(),dirty:l,skip_bound:!1,root:e.target||c.$$.root};o&&o(a.root);let h=!1;if(a.ctx=t?t(s,e.props||{},(u,p,...f)=>{const d=f.length?f[0]:p;return a.ctx&&i(a.ctx[u],a.ctx[u]=d)&&(!a.skip_bound&&a.bound[u]&&a.bound[u](d),h&&Lt(s,u)),p}):[],a.update(),h=!0,K(a.before_update),a.fragment=n?n(a.ctx):!1,e.target){if(e.hydrate){ut();const u=E(e.target);a.fragment&&a.fragment.l(u),u.forEach(_)}else a.fragment&&a.fragment.c();e.intro&&R(s.$$.fragment),W(s,e.target,e.anchor),ht(),Ze()}le(c)}class oe{$$=void 0;$$set=void 0;$destroy(){H(this,1),this.$destroy=x}$on(e,t){if(!Te(t))return x;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!ot(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ut="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ut);class U extends Error{constructor(e){super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,U.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof U||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=this.response?.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":this.originalError?.cause?.message?.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const fe=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Nt(s,e){const t={};if(typeof s!="string")return t;const n=Object.assign({},e||{}).decode||Dt;let i=0;for(;i<s.length;){const r=s.indexOf("=",i);if(r===-1)break;let o=s.indexOf(";",i);if(o===-1)o=s.length;else if(o<r){i=s.lastIndexOf(";",r-1)+1;continue}const l=s.slice(i,r).trim();if(t[l]===void 0){let c=s.slice(r+1,o).trim();c.charCodeAt(0)===34&&(c=c.slice(1,-1));try{t[l]=n(c)}catch{t[l]=c}}i=o+1}return t}function De(s,e,t){const n=Object.assign({},t||{}),i=n.encode||Ft;if(!fe.test(s))throw new TypeError("argument name is invalid");const r=i(e);if(r&&!fe.test(r))throw new TypeError("argument val is invalid");let o=s+"="+r;if(n.maxAge!=null){const l=n.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(l)}if(n.domain){if(!fe.test(n.domain))throw new TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!fe.test(n.path))throw new TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){if(!function(c){return Object.prototype.toString.call(c)==="[object Date]"||c instanceof Date}(n.expires)||isNaN(n.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():n.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Dt(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function Ft(s){return encodeURIComponent(s)}let et;function ge(s){if(s)try{const e=decodeURIComponent(et(s.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function tt(s,e=0){let t=ge(s);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}et=typeof atob=="function"?atob:s=>{let e=String(s).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,n,i=0,r=0,o="";n=e.charAt(r++);~n&&(t=i%4?64*t+n:n,i++%4)?o+=String.fromCharCode(255&t>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};const Fe="pb_auth";class Bt{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!tt(this.token)}get isAdmin(){return ge(this.token).type==="admin"}get isAuthRecord(){return ge(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=Fe){const n=Nt(e||"")[t]||"";let i={};try{i=JSON.parse(n),(typeof i===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.model||null)}exportToCookie(e,t=Fe){const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},i=ge(this.token);n.expires=i?.exp?new Date(1e3*i.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const r={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null};let o=De(t,JSON.stringify(r),e);const l=typeof Blob<"u"?new Blob([o]).size:o.length;if(r.model&&l>4096){r.model={id:r?.model?.id,email:r?.model?.email};const c=["collectionId","username","verified"];for(const a in this.model)c.includes(a)&&(r.model[a]=this.model[a]);o=De(t,JSON.stringify(r),e)}return o}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let n=this._onChangeCallbacks.length-1;n>=0;n--)if(this._onChangeCallbacks[n]==e)return delete this._onChangeCallbacks[n],void this._onChangeCallbacks.splice(n,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.model)}}class Kt extends Bt{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&window?.localStorage){const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window<"u"&&window?.localStorage){let n=t;typeof t!="string"&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){typeof window<"u"&&window?.localStorage&&window.localStorage?.removeItem(e),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&window?.localStorage&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}}class J{constructor(e){this.client=e}}class Mt extends J{getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}testEmail(e,t,n){return n=Object.assign({method:"POST",body:{email:e,template:t}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}generateAppleClientSecret(e,t,n,i,r,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:i,duration:r}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}class xe extends J{decode(e){return e}getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(i=>(i.items=i.items?.map(r=>this.decode(r))||[],i))}getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(n=>{if(!n?.items?.length)throw new U({status:404,data:{code:404,message:"The requested resource wasn't found.",data:{}}});return n.items[0]})}getOne(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(n=>this.decode(n))}create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(n=>this.decode(n))}update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(i=>this.decode(i))}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],i=async r=>this.getList(r,e||500,t).then(o=>{const l=o.items;return n=n.concat(l),l.length==o.perPage?i(r+1):n});return i(1)}}function q(s,e,t,n){const i=n!==void 0;return i||t!==void 0?i?(console.warn(s),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,n),e):Object.assign(e,t):e}function Se(s){s._resetAutoRefresh?.()}class zt extends xe{get baseCrudPath(){return"/api/admins"}update(e,t,n){return super.update(e,t,n).then(i=>(this.client.authStore.model?.id===i.id&&this.client.authStore.model?.collectionId===void 0&&this.client.authStore.save(this.client.authStore.token,i),i))}delete(e,t){return super.delete(e,t).then(n=>(n&&this.client.authStore.model?.id===e&&this.client.authStore.model?.collectionId===void 0&&this.client.authStore.clear(),n))}authResponse(e){const t=this.decode(e?.admin||{});return e?.token&&e?.admin&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:e?.token||"",admin:t})}async authWithPassword(e,t,n,i){let r={method:"POST",body:{identity:e,password:t}};r=q("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",r,n,i);const o=r.autoRefreshThreshold;delete r.autoRefreshThreshold,r.autoRefresh||Se(this.client);let l=await this.client.send(this.baseCrudPath+"/auth-with-password",r);return l=this.authResponse(l),o&&function(a,h,u,p){Se(a);const f=a.beforeSend,d=a.authStore.model,C=a.authStore.onChange((b,v)=>{(!b||v?.id!=d?.id||(v?.collectionId||d?.collectionId)&&v?.collectionId!=d?.collectionId)&&Se(a)});a._resetAutoRefresh=function(){C(),a.beforeSend=f,delete a._resetAutoRefresh},a.beforeSend=async(b,v)=>{const m=a.authStore.token;if(v.query?.autoRefresh)return f?f(b,v):{url:b,sendOptions:v};let g=a.authStore.isValid;if(g&&tt(a.authStore.token,h))try{await u()}catch{g=!1}g||await p();const S=v.headers||{};for(let T in S)if(T.toLowerCase()=="authorization"&&m==S[T]&&a.authStore.token){S[T]=a.authStore.token;break}return v.headers=S,f?f(b,v):{url:b,sendOptions:v}}}(this.client,o,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},r))),l}authRefresh(e,t){let n={method:"POST"};return n=q("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",n).then(this.authResponse.bind(this))}requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=q("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCrudPath+"/request-password-reset",i).then(()=>!0)}confirmPasswordReset(e,t,n,i,r){let o={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return o=q("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",o,i,r),this.client.send(this.baseCrudPath+"/confirm-password-reset",o).then(()=>!0)}}const Vt=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function nt(s){if(s){s.query=s.query||{};for(let e in s)Vt.includes(e)||(s.query[e]=s[e],delete s[e])}}class st extends J{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){if(!e)throw new Error("topic must be set.");let i=e;if(n){nt(n);const o="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));i+=(i.includes("?")?"&":"?")+o}const r=function(o){const l=o;let c;try{c=JSON.parse(l?.data)}catch{}t(c||{})};return this.subscriptions[i]||(this.subscriptions[i]=[]),this.subscriptions[i].push(r),this.isConnected?this.subscriptions[i].length===1?await this.submitSubscriptions():this.eventSource?.addEventListener(i,r):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,r)}async unsubscribe(e){let t=!1;if(e){const n=this.getSubscriptionsByTopic(e);for(let i in n)if(this.hasSubscriptionListeners(i)){for(let r of this.subscriptions[i])this.eventSource?.removeEventListener(i,r);delete this.subscriptions[i],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){let t=!1;for(let n in this.subscriptions)if((n+"?").startsWith(e)){t=!0;for(let i of this.subscriptions[n])this.eventSource?.removeEventListener(n,i);delete this.subscriptions[n]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){let n=!1;const i=this.getSubscriptionsByTopic(e);for(let r in i){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let o=!1;for(let l=this.subscriptions[r].length-1;l>=0;l--)this.subscriptions[r][l]===t&&(o=!0,delete this.subscriptions[r][l],this.subscriptions[r].splice(l,1),this.eventSource?.removeEventListener(r,t));o&&(this.subscriptions[r].length||delete this.subscriptions[r],n||this.hasSubscriptionListeners(r)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){if(this.subscriptions=this.subscriptions||{},e)return!!this.subscriptions[e]?.length;for(let t in this.subscriptions)if(this.subscriptions[t]?.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!e?.isAbort)throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t?.lastEventId,this.submitSubscriptions().then(async()=>{let n=3;for(;this.hasUnsentSubscriptions()&&n>0;)n--,await this.submitSubscriptions()}).then(()=>{for(let i of this.pendingConnects)i.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const n=this.getSubscriptionsByTopic("PB_CONNECT");for(let i in n)for(let r of n[i])r(e)}).catch(n=>{this.clientId="",this.connectErrorHandler(n)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let n of this.pendingConnects)n.reject(new U(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),this.eventSource?.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let t of this.pendingConnects)t.resolve();this.pendingConnects=[]}}}class Wt extends xe{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}getList(e=1,t=30,n){return super.getList(e,t,n)}getFirstListItem(e,t){return super.getFirstListItem(e,t)}getOne(e,t){return super.getOne(e,t)}create(e,t){return super.create(e,t)}update(e,t,n){return super.update(e,t,n).then(i=>(this.client.authStore.model?.id!==i?.id||this.client.authStore.model?.collectionId!==this.collectionIdOrName&&this.client.authStore.model?.collectionName!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,i),i))}delete(e,t){return super.delete(e,t).then(n=>(!n||this.client.authStore.model?.id!==e||this.client.authStore.model?.collectionId!==this.collectionIdOrName&&this.client.authStore.model?.collectionName!==this.collectionIdOrName||this.client.authStore.clear(),n))}authResponse(e){const t=this.decode(e?.record||{});return this.client.authStore.save(e?.token,t),Object.assign({},e,{token:e?.token||"",record:t})}listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!t?.usernamePassword,emailPassword:!!t?.emailPassword,authProviders:Array.isArray(t?.authProviders)?t?.authProviders:[]}))}authWithPassword(e,t,n,i){let r={method:"POST",body:{identity:e,password:t}};return r=q("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",r,n,i),this.client.send(this.baseCollectionPath+"/auth-with-password",r).then(o=>this.authResponse(o))}authWithOAuth2Code(e,t,n,i,r,o,l){let c={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectUrl:i,createData:r}};return c=q("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",c,o,l),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",c).then(a=>this.authResponse(a))}async authWithOAuth2(...e){if(e.length>1||typeof e?.[0]=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code(e?.[0]||"",e?.[1]||"",e?.[2]||"",e?.[3]||"",e?.[4]||{},e?.[5]||{},e?.[6]||{});const t=e?.[0]||{},n=(await this.listAuthMethods()).authProviders.find(c=>c.name===t.provider);if(!n)throw new U(new Error(`Missing or invalid provider "${t.provider}".`));const i=this.client.buildUrl("/api/oauth2-redirect"),r=new st(this.client);let o=null;function l(){o?.close(),r.unsubscribe()}return t.urlCallback||(o=Be(void 0)),new Promise(async(c,a)=>{try{await r.subscribe("@oauth2",async f=>{const d=r.clientId;try{if(!f.state||d!==f.state)throw new Error("State parameters don't match.");const C=Object.assign({},t);delete C.provider,delete C.scopes,delete C.createData,delete C.urlCallback;const b=await this.authWithOAuth2Code(n.name,f.code,n.codeVerifier,i,t.createData,C);c(b)}catch(C){a(new U(C))}l()});const h={state:r.clientId};t.scopes?.length&&(h.scope=t.scopes.join(" "));const u=this._replaceQueryParams(n.authUrl+i,h);await(t.urlCallback||function(f){o?o.location.href=f:o=Be(f)})(u)}catch(h){l(),a(new U(h))}})}authRefresh(e,t){let n={method:"POST"};return n=q("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(i=>this.authResponse(i))}requestPasswordReset(e,t,n){let i={method:"POST",body:{email:e}};return i=q("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",i).then(()=>!0)}confirmPasswordReset(e,t,n,i,r){let o={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return o=q("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,i,r),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}requestVerification(e,t,n){let i={method:"POST",body:{email:e}};return i=q("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-verification",i).then(()=>!0)}confirmVerification(e,t,n){let i={method:"POST",body:{token:e}};return i=q("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",i).then(()=>!0)}requestEmailChange(e,t,n){let i={method:"POST",body:{newEmail:e}};return i=q("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",i,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",i).then(()=>!0)}confirmEmailChange(e,t,n,i){let r={method:"POST",body:{token:e,password:t}};return r=q("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",r,n,i),this.client.send(this.baseCollectionPath+"/confirm-email-change",r).then(()=>!0)}listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}unlinkExternalAuth(e,t,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),n).then(()=>!0)}_replaceQueryParams(e,t={}){let n=e,i="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),i=e.substring(e.indexOf("?")+1));const r={},o=i.split("&");for(const l of o){if(l=="")continue;const c=l.split("=");r[decodeURIComponent(c[0].replace(/\+/g," "))]=decodeURIComponent((c[1]||"").replace(/\+/g," "))}for(let l in t)t.hasOwnProperty(l)&&(t[l]==null?delete r[l]:r[l]=t[l]);i="";for(let l in r)r.hasOwnProperty(l)&&(i!=""&&(i+="&"),i+=encodeURIComponent(l.replace(/%20/g,"+"))+"="+encodeURIComponent(r[l].replace(/%20/g,"+")));return i!=""?n+"?"+i:n}}function Be(s){if(typeof window>"u"||!window?.open)throw new U(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,n=window.innerWidth,i=window.innerHeight;e=e>n?n:e,t=t>i?i:t;let r=n/2-e/2,o=i/2-t/2;return window.open(s,"popup_window","width="+e+",height="+t+",top="+o+",left="+r+",resizable,menubar=no")}class Ht extends xe{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}}class Gt extends J{getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}getOne(e,t){return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Jt extends J{check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Qt extends J{getUrl(e,t,n={}){if(!t||!e?.id||!e?.collectionId&&!e?.collectionName)return"";const i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(e.collectionId||e.collectionName)),i.push(encodeURIComponent(e.id)),i.push(encodeURIComponent(t));let r=this.client.buildUrl(i.join("/"));if(Object.keys(n).length){n.download===!1&&delete n.download;const o=new URLSearchParams(n);r+=(r.includes("?")?"&":"?")+o}return r}getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>t?.token||"")}}class Yt extends J{getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class Xt{constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=n,this.authStore=t||new Kt,this.admins=new zt(this),this.collections=new Ht(this),this.files=new Qt(this),this.logs=new Gt(this),this.settings=new Mt(this),this.realtime=new st(this),this.health=new Jt(this),this.backups=new Yt(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Wt(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let i=t[n];switch(typeof i){case"boolean":case"number":i=""+i;break;case"string":i="'"+i.replace(/'/g,"\\'")+"'";break;default:i=i===null?"null":i instanceof Date?"'"+i.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(i).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",i)}return e}getFileUrl(e,t,n={}){return this.files.getUrl(e,t,n)}buildUrl(e){let t=this.baseUrl;return typeof window>"u"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=window.location.origin?.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildUrl(e);if(this.beforeSend){const i=Object.assign({},await this.beforeSend(n,t));i.url!==void 0||i.options!==void 0?(n=i.url||n,t=i.options||t):Object.keys(i).length&&(t=i,console?.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){const i=this.serializeQueryParams(t.query);i&&(n+=(n.includes("?")?"&":"?")+i),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async i=>{let r={};try{r=await i.json()}catch{}if(this.afterSend&&(r=await this.afterSend(i,r)),i.status>=400)throw new U({url:i.url,status:i.status,data:r});return r}).catch(i=>{throw new U(i)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),nt(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const i=new AbortController;this.cancelControllers[n]=i,t.signal=i.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData>"u"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;const t=new FormData;for(let n in e){const i=Array.isArray(e[n])?e[n]:[e[n]];for(let r of i)t.append(n,r)}return t}hasBlobField(e){for(let t in e){const n=Array.isArray(e[t])?e[t]:[e[t]];for(let i of n)if(typeof Blob<"u"&&i instanceof Blob||typeof File<"u"&&i instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData<"u"&&e instanceof FormData)}serializeQueryParams(e){const t=[];for(const n in e){if(e[n]===null)continue;const i=e[n],r=encodeURIComponent(n);if(Array.isArray(i))for(const o of i)t.push(r+"="+encodeURIComponent(o));else i instanceof Date?t.push(r+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?t.push(r+"="+encodeURIComponent(JSON.stringify(i))):t.push(r+"="+encodeURIComponent(i))}return t.join("&")}}const Y=[];function it(s,e=x){let t;const n=new Set;function i(l){if(G(s,l)&&(s=l,t)){const c=!Y.length;for(const a of n)a[1](),Y.push(a,s);if(c){for(let a=0;a<Y.length;a+=2)Y[a][0](Y[a+1]);Y.length=0}}}function r(l){i(l(s))}function o(l,c=x){const a=[l,c];return n.add(a),n.size===1&&(t=e(i,r)||x),l(s),()=>{n.delete(a),n.size===0&&t&&(t(),t=null)}}return{set:i,update:r,subscribe:o}}const F=new Xt("https://endless-struggle.pockethost.io/"),Ae=it(F.authStore.model);F.authStore.onChange(()=>{Ae.set(F.authStore.model)});function Zt(s){let e,t,n,i="Username",r,o,l,c,a,h="Password",u,p,f,d,C,b,v,m;return{c(){e=O("form"),t=O("div"),n=O("label"),n.textContent=i,r=P(),o=O("input"),l=P(),c=O("div"),a=O("label"),a.textContent=h,u=P(),p=O("input"),f=P(),d=O("input"),C=P(),b=O("input"),this.h()},l(g){e=k(g,"FORM",{});var S=E(e);t=k(S,"DIV",{class:!0});var T=E(t);n=k(T,"LABEL",{for:!0,"data-svelte-h":!0}),V(n)!=="svelte-1wr0xay"&&(n.textContent=i),r=I(T),o=k(T,"INPUT",{id:!0,type:!0,placeholder:!0}),T.forEach(_),l=I(S),c=k(S,"DIV",{class:!0});var j=E(c);a=k(j,"LABEL",{for:!0,"data-svelte-h":!0}),V(a)!=="svelte-pepa0a"&&(a.textContent=h),u=I(j),p=k(j,"INPUT",{id:!0,type:!0,placeholder:!0}),j.forEach(_),f=I(S),d=k(S,"INPUT",{type:!0}),C=I(S),b=k(S,"INPUT",{type:!0}),S.forEach(_),this.h()},h(){w(n,"for","username"),w(o,"id","username"),w(o,"type","text"),w(o,"placeholder","username"),o.required=!0,w(t,"class","form-item svelte-ym0voz"),w(a,"for","password"),w(p,"id","password"),w(p,"type","password"),w(p,"placeholder","password"),p.required=!0,w(c,"class","form-item svelte-ym0voz"),w(d,"type","submit"),d.value="Log in",w(b,"type","submit"),b.value="Sign up"},m(g,S){A(g,e,S),y(e,t),y(t,n),y(t,r),y(t,o),Z(o,s[0]),y(e,l),y(e,c),y(c,a),y(c,u),y(c,p),Z(p,s[1]),y(e,f),y(e,d),y(e,C),y(e,b),v||(m=[B(o,"input",s[5]),B(p,"input",s[6]),B(d,"click",s[2]),B(b,"click",s[3]),B(e,"submit",Qe(s[4]))],v=!0)},p(g,[S]){S&1&&o.value!==g[0]&&Z(o,g[0]),S&2&&p.value!==g[1]&&Z(p,g[1])},i:x,o:x,d(g){g&&_(e),v=!1,K(m)}}}function en(s,e,t){let n,i;async function r(){if(!(n===void 0||i===void 0))try{const u=await F.collection("users").authWithPassword(n,i);l()}catch(u){console.log(u)}}async function o(){if(!(n===void 0||i===void 0))try{const u={username:n,password:i,passwordConfirm:i,name:n,role:"user"},p=await F.collection("users").create(u);await r(),l()}catch(u){console.log(u)}}function l(){t(0,n=""),t(1,i="")}function c(u){Et.call(this,s,u)}function a(){n=this.value,t(0,n)}function h(){i=this.value,t(1,i)}return[n,i,r,o,c,a,h]}class tn extends oe{constructor(e){super(),re(this,e,en,Zt,G,{})}}function nn(s){let e,t="Log out",n,i;return{c(){e=O("button"),e.textContent=t,this.h()},l(r){e=k(r,"BUTTON",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-vmi6ig"&&(e.textContent=t),this.h()},h(){w(e,"class","svelte-3904c9")},m(r,o){A(r,e,o),n||(i=B(e,"click",s[0]),n=!0)},p:x,i:x,o:x,d(r){r&&_(e),n=!1,i()}}}function sn(s){function e(){F.authStore.clear()}return[e]}class rn extends oe{constructor(e){super(),re(this,e,sn,nn,G,{})}}function on(s){let e,t;return{c(){e=O("img"),this.h()},l(n){e=k(n,"IMG",{width:!0,height:!0,src:!0,alt:!0}),this.h()},h(){w(e,"width",72),w(e,"height",72),qe(e.src,t=`https://api.dicebear.com/7.x/icons/svg?backgroundColor=b6e3f4,c0aede,d1d4f9&backgroundType=gradientLinear&seed=${s[0]}`)||w(e,"src",t),w(e,"alt","")},m(n,i){A(n,e,i)},p(n,[i]){i&1&&!qe(e.src,t=`https://api.dicebear.com/7.x/icons/svg?backgroundColor=b6e3f4,c0aede,d1d4f9&backgroundType=gradientLinear&seed=${n[0]}`)&&w(e,"src",t)},i:x,o:x,d(n){n&&_(e)}}}function an(s,e,t){let{seed:n}=e;return s.$$set=i=>{"seed"in i&&t(0,n=i.seed)},[n]}class rt extends oe{constructor(e){super(),re(this,e,an,on,G,{seed:0})}}function ln(s,{delay:e=0,duration:t=400,easing:n=Ve}={}){const i=+getComputedStyle(s).opacity;return{delay:e,duration:t,easing:n,css:r=>`opacity: ${r*i}`}}const pe=it([]);function Ke(s,e,t){const n=s.slice();return n[6]=e[t],n}function Me(s,e){let t,n,i,r,o,l,c,a=e[6].expand?.author?.name+"",h,u,p,f=e[6].text+"",d,C,b,v;return i=new rt({props:{seed:e[6].expand?.author?.name??""}}),{key:s,first:null,c(){t=O("li"),n=O("div"),se(i.$$.fragment),r=P(),o=O("div"),l=O("div"),c=z("@"),h=z(a),u=P(),p=O("div"),d=z(f),C=P(),this.h()},l(m){t=k(m,"LI",{class:!0});var g=E(t);n=k(g,"DIV",{class:!0});var S=E(n);ie(i.$$.fragment,S),S.forEach(_),r=I(g),o=k(g,"DIV",{class:!0});var T=E(o);l=k(T,"DIV",{class:!0});var j=E(l);c=te(j,"@"),h=te(j,a),j.forEach(_),u=I(T),p=k(T,"DIV",{class:!0});var $=E(p);d=te($,f),$.forEach(_),T.forEach(_),C=I(g),g.forEach(_),this.h()},h(){w(n,"class","message-image shadow-md svelte-907hxp"),w(l,"class","author svelte-907hxp"),w(p,"class","content"),w(o,"class","message-body"),w(t,"class","message svelte-907hxp"),this.first=t},m(m,g){A(m,t,g),y(t,n),W(i,n,null),y(t,r),y(t,o),y(o,l),y(l,c),y(l,h),y(o,u),y(o,p),y(p,d),y(t,C),v=!0},p(m,g){e=m;const S={};g&2&&(S.seed=e[6].expand?.author?.name??""),i.$set(S),(!v||g&2)&&a!==(a=e[6].expand?.author?.name+"")&&Ce(h,a),(!v||g&2)&&f!==(f=e[6].text+"")&&Ce(d,f)},i(m){v||(R(i.$$.fragment,m),m&&(b||ue(()=>{b=Rt(t,ln,{duration:240}),b.start()})),v=!0)},o(m){L(i.$$.fragment,m),v=!1},d(m){m&&_(t),H(i)}}}function cn(s){let e,t,n=[],i=new Map,r,o,l,c=Ne(s[1]);const a=h=>h[6].id;for(let h=0;h<c.length;h+=1){let u=Ke(s,c,h),p=a(u);i.set(p,n[h]=Me(p,u))}return{c(){e=O("div"),t=O("ul");for(let h=0;h<n.length;h+=1)n[h].c();r=P(),o=O("div"),this.h()},l(h){e=k(h,"DIV",{class:!0});var u=E(e);t=k(u,"UL",{class:!0});var p=E(t);for(let f=0;f<n.length;f+=1)n[f].l(p);p.forEach(_),r=I(u),o=k(u,"DIV",{id:!0}),E(o).forEach(_),u.forEach(_),this.h()},h(){w(t,"class","svelte-907hxp"),w(o,"id","bottom"),w(e,"class","message-list shadow-md svelte-907hxp")},m(h,u){A(h,e,u),y(e,t);for(let p=0;p<n.length;p+=1)n[p]&&n[p].m(t,null);y(e,r),y(e,o),s[2](o),l=!0},p(h,[u]){u&2&&(c=Ne(h[1]),Ee(),n=jt(n,u,a,1,h,c,i,t,qt,Me,null,Ke),$e())},i(h){if(!l){for(let u=0;u<c.length;u+=1)R(n[u]);l=!0}},o(h){for(let u=0;u<n.length;u+=1)L(n[u]);l=!1},d(h){h&&_(e);for(let u=0;u<n.length;u+=1)n[u].d();s[2](null)}}}function un(s,e,t){let n;Pe(s,pe,a=>t(1,n=a));let i=()=>{},r;Ot(async()=>{const a=await F.collection("posts").getList(1,50,{sort:"created",expand:"author"});_e(pe,n=a.items,n),i=await F.collection("posts").subscribe("*",o),l()}),kt(async()=>{i()});async function o({action:a,record:h}){if(a==="create"){const u=await F.collection("users").getOne(h.author);h.expand={author:u},_e(pe,n=[...n,h],n),l()}a==="delete"&&_e(pe,n=n.filter(u=>u.id!==h.id),n)}function l(){setTimeout(()=>{r.scrollIntoView({behavior:"auto"})},10)}function c(a){Oe[a?"unshift":"push"](()=>{r=a,t(0,r)})}return[r,n,c]}class hn extends oe{constructor(e){super(),re(this,e,un,cn,G,{})}}function dn(s){let e,t,n,i,r,o;return{c(){e=O("form"),t=O("input"),n=P(),i=O("input"),this.h()},l(l){e=k(l,"FORM",{class:!0});var c=E(e);t=k(c,"INPUT",{type:!0,placeholder:!0}),n=I(c),i=k(c,"INPUT",{type:!0}),c.forEach(_),this.h()},h(){w(t,"type","text"),w(t,"placeholder","post..."),t.required=!0,w(i,"type","submit"),w(e,"class","svelte-1631mkx")},m(l,c){A(l,e,c),y(e,t),Z(t,s[0]),y(e,n),y(e,i),r||(o=[B(t,"input",s[2]),B(e,"submit",Qe(s[1]))],r=!0)},p(l,[c]){c&1&&t.value!==l[0]&&Z(t,l[0])},i:x,o:x,d(l){l&&_(e),r=!1,K(o)}}}function fn(s,e,t){let n;Pe(s,Ae,l=>t(3,n=l));let i="";async function r(){if(i==="")return;const l=i;t(0,i="");const c={text:l,author:n?.id};await F.collection("posts").create(c)}function o(){i=this.value,t(0,i)}return[i,r,o]}class pn extends oe{constructor(e){super(),re(this,e,fn,dn,G,{})}}function ze(s){let e,t,n,i,r,o,l=s[0].username+"",c,a,h,u,p;return t=new rn({}),u=new rt({props:{seed:s[0].username}}),{c(){e=O("div"),se(t.$$.fragment),n=P(),i=O("p"),r=z("Hello, "),o=O("span"),c=z(l),a=P(),h=O("div"),se(u.$$.fragment),this.h()},l(f){e=k(f,"DIV",{class:!0});var d=E(e);ie(t.$$.fragment,d),n=I(d),i=k(d,"P",{});var C=E(i);r=te(C,"Hello, "),o=k(C,"SPAN",{class:!0});var b=E(o);c=te(b,l),b.forEach(_),C.forEach(_),a=I(d),h=k(d,"DIV",{class:!0});var v=E(h);ie(u.$$.fragment,v),v.forEach(_),d.forEach(_),this.h()},h(){w(o,"class","username svelte-14863dz"),w(h,"class","user-image shadow-sm svelte-14863dz"),w(e,"class","user-card svelte-14863dz")},m(f,d){A(f,e,d),W(t,e,null),y(e,n),y(e,i),y(i,r),y(i,o),y(o,c),y(e,a),y(e,h),W(u,h,null),p=!0},p(f,d){(!p||d&1)&&l!==(l=f[0].username+"")&&Ce(c,l);const C={};d&1&&(C.seed=f[0].username),u.$set(C)},i(f){p||(R(t.$$.fragment,f),R(u.$$.fragment,f),p=!0)},o(f){L(t.$$.fragment,f),L(u.$$.fragment,f),p=!1},d(f){f&&_(e),H(t),H(u)}}}function mn(s){let e,t,n,i="Sign in to continue",r,o,l;return o=new tn({}),{c(){e=O("div"),t=O("div"),n=O("h2"),n.textContent=i,r=P(),se(o.$$.fragment),this.h()},l(c){e=k(c,"DIV",{class:!0});var a=E(e);t=k(a,"DIV",{class:!0});var h=E(t);n=k(h,"H2",{class:!0,"data-svelte-h":!0}),V(n)!=="svelte-tg8ljm"&&(n.textContent=i),r=I(h),ie(o.$$.fragment,h),h.forEach(_),a.forEach(_),this.h()},h(){w(n,"class","pad"),w(t,"class","sign-in-container svelte-14863dz"),w(e,"class","sign-in-wrapper svelte-14863dz")},m(c,a){A(c,e,a),y(e,t),y(t,n),y(t,r),W(o,t,null),l=!0},i(c){l||(R(o.$$.fragment,c),l=!0)},o(c){L(o.$$.fragment,c),l=!1},d(c){c&&_(e),H(o)}}}function gn(s){let e,t,n,i,r="Send a post",o,l,c;return t=new hn({}),l=new pn({}),{c(){e=O("div"),se(t.$$.fragment),n=P(),i=O("p"),i.textContent=r,o=P(),se(l.$$.fragment),this.h()},l(a){e=k(a,"DIV",{class:!0});var h=E(e);ie(t.$$.fragment,h),h.forEach(_),n=I(a),i=k(a,"P",{"data-svelte-h":!0}),V(i)!=="svelte-ummdzd"&&(i.textContent=r),o=I(a),ie(l.$$.fragment,a),this.h()},h(){w(e,"class","message-container")},m(a,h){A(a,e,h),W(t,e,null),A(a,n,h),A(a,i,h),A(a,o,h),W(l,a,h),c=!0},i(a){c||(R(t.$$.fragment,a),R(l.$$.fragment,a),c=!0)},o(a){L(t.$$.fragment,a),L(l.$$.fragment,a),c=!1},d(a){a&&(_(e),_(n),_(i),_(o)),H(t),H(l,a)}}}function bn(s){let e,t,n,i="Endless Struggle",r,o,l,c,a,h,u,p='<div class="footer-content svelte-14863dz"><p>Created by FireIsGood</p></div>',f,d=s[0]&&ze(s);const C=[gn,mn],b=[];function v(m,g){return m[0]?0:1}return c=v(s),a=b[c]=C[c](s),{c(){e=O("header"),t=O("div"),n=O("h1"),n.textContent=i,r=P(),d&&d.c(),o=P(),l=O("main"),a.c(),h=P(),u=O("footer"),u.innerHTML=p,this.h()},l(m){e=k(m,"HEADER",{class:!0});var g=E(e);t=k(g,"DIV",{class:!0});var S=E(t);n=k(S,"H1",{"data-svelte-h":!0}),V(n)!=="svelte-14t5sun"&&(n.textContent=i),r=I(S),d&&d.l(S),S.forEach(_),g.forEach(_),o=I(m),l=k(m,"MAIN",{class:!0});var T=E(l);a.l(T),T.forEach(_),h=I(m),u=k(m,"FOOTER",{class:!0,"data-svelte-h":!0}),V(u)!=="svelte-8udjqc"&&(u.innerHTML=p),this.h()},h(){w(t,"class","header-content svelte-14863dz"),w(e,"class","svelte-14863dz"),w(l,"class","svelte-14863dz"),w(u,"class","svelte-14863dz")},m(m,g){A(m,e,g),y(e,t),y(t,n),y(t,r),d&&d.m(t,null),A(m,o,g),A(m,l,g),b[c].m(l,null),A(m,h,g),A(m,u,g),f=!0},p(m,[g]){m[0]?d?(d.p(m,g),g&1&&R(d,1)):(d=ze(m),d.c(),R(d,1),d.m(t,null)):d&&(Ee(),L(d,1,1,()=>{d=null}),$e());let S=c;c=v(m),c!==S&&(Ee(),L(b[S],1,1,()=>{b[S]=null}),$e(),a=b[c],a||(a=b[c]=C[c](m),a.c()),R(a,1),a.m(l,null))},i(m){f||(R(d),R(a),f=!0)},o(m){L(d),L(a),f=!1},d(m){m&&(_(e),_(o),_(l),_(h),_(u)),d&&d.d(),b[c].d()}}}function yn(s,e,t){let n;return Pe(s,Ae,i=>t(0,n=i)),[n]}class _n extends oe{constructor(e){super(),re(this,e,yn,bn,G,{})}}export{_n as default};
